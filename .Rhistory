library(shiny)
library(shinydashboard)
library(tidyverse)
library(leaflet)
library(shiny)
library(shinydashboard)
library(tidyverse)
capture <- read.csv("Data/NWTMyotisCaptureRecords_ReimerBarclay2023.csv",
na.strings = c("", " ")
)
library(shiny)
library(shinydashboard)
library(tidyverse)
# -------- LOAD CAPTURE DATA --------
capture_raw <- read.csv(
"Data/NWTMyotisCaptureRecords_ReimerBarclay2023.csv",
na.strings = c("", " ")
)
# Convert to proper types
capture_raw$Region <- as.factor(capture_raw$Region)
capture_raw$Sex <- as.factor(capture_raw$Sex)
capture_raw$Ageclass <- as.factor(capture_raw$Ageclass)
capture_raw$Reproductivestatus <- as.factor(capture_raw$Reproductivestatus)
# Remove NA in variables of interest
capture_clean <- capture_raw %>%
filter(
!is.na(Region),
!is.na(Sex),
!is.na(Ageclass),
!is.na(Reproductivestatus),
!is.na(Forearmlengthmm),
!is.na(Earlengthmm)
)
# -------- REMOVE EAR LENGTH OUTLIERS (IQR method) --------
Q3 <- quantile(capture_clean$Earlengthmm, 0.75)
IQR_val <- IQR(capture_clean$Earlengthmm)
upper_bound <- Q3 + 1.5 * IQR_val
capture <- capture_clean %>%
filter(Earlengthmm <= upper_bound)
# Convert categorical variables
capture$Region <- as.factor(capture$Region)
capture$Sex <- as.factor(capture$Sex)
capture$Ageclass <- as.factor(capture$Ageclass)
capture$Reproductivestatus <- as.factor(capture$Reproductivestatus)
ui <- dashboardPage(
dashboardHeader(title = "Capture Morphology Analysis"),
dashboardSidebar(
sidebarMenu(
menuItem("Forearm Analysis", tabName = "forearm"),
menuItem("Ear Analysis", tabName = "ear"),
menuItem("Morphological Scaling", tabName = "scaling"),
menuItem("Categorical Associations", tabName = "cat")
)
),
dashboardBody(
tabItems(
# -------- FOREARM TAB --------
tabItem(tabName = "forearm",
fluidRow(
box(width = 4,
selectInput("forearm_x",
"Group Variable",
choices = c("Sex",
"Ageclass",
"Region",
"Reproductivestatus"))
),
box(width = 8,
plotOutput("forearm_plot"),
verbatimTextOutput("forearm_test")
)
)
),
# -------- EAR TAB --------
tabItem(tabName = "ear",
fluidRow(
box(width = 4,
selectInput("ear_x",
"Group Variable",
choices = c("Sex",
"Ageclass",
"Region",
"Reproductivestatus"))
),
box(width = 8,
plotOutput("ear_plot"),
verbatimTextOutput("ear_test")
)
)
),
# -------- SCALING TAB --------
tabItem(tabName = "scaling",
fluidRow(
box(width = 12,
plotOutput("scaling_plot"),
verbatimTextOutput("scaling_test")
)
)
),
# -------- CATEGORICAL TAB --------
tabItem(tabName = "cat",
fluidRow(
box(width = 4,
selectInput("cat1",
"Variable 1",
choices = c("Sex",
"Ageclass",
"Region",
"Reproductivestatus")),
selectInput("cat2",
"Variable 2",
choices = c("Sex",
"Ageclass",
"Region",
"Reproductivestatus"))
),
box(width = 8,
tableOutput("cat_table"),
verbatimTextOutput("cat_test")
)
)
)
)
)
)
server <- function(input, output) {
# -------- FOREARM --------
output$forearm_plot <- renderPlot({
ggplot(capture,
aes_string(x = input$forearm_x,
y = "Forearmlengthmm",
fill = input$forearm_x)) +
geom_boxplot() +
theme_minimal() +
labs(y = "Forearm Length (mm)")
})
output$forearm_test <- renderPrint({
summary(aov(Forearmlengthmm ~
capture[[input$forearm_x]],
data = capture))
})
# -------- EAR --------
output$ear_plot <- renderPlot({
ggplot(capture,
aes_string(x = input$ear_x,
y = "Earlengthmm",
fill = input$ear_x)) +
geom_boxplot() +
theme_minimal() +
labs(y = "Ear Length (mm)")
})
output$ear_test <- renderPrint({
summary(aov(Earlengthmm ~
capture[[input$ear_x]],
data = capture))
})
# -------- SCALING --------
output$scaling_plot <- renderPlot({
ggplot(capture,
aes(Forearmlengthmm,
Earlengthmm)) +
geom_point() +
geom_smooth(method = "lm",
se = FALSE,
color = "red") +
theme_minimal()
})
output$scaling_test <- renderPrint({
summary(lm(Earlengthmm ~ Forearmlengthmm,
data = capture))
})
# -------- CATEGORICAL --------
output$cat_table <- renderTable({
table(capture[[input$cat1]],
capture[[input$cat2]])
})
output$cat_test <- renderPrint({
chisq.test(table(capture[[input$cat1]],
capture[[input$cat2]]))
})
}
shinyApp(ui, server)
View(capture)
View(capture_clean)
capture %>%
select(latitude, longitude) %>%
summary()
capture %>%
select(Latitude, Longitude) %>%
summary()
lat <- c(59.7, 60.96)
long <-c(-117.4, -112.2)
batbox <- make_bbox(long, lat, f=0.03)
library(tidyverse)
library(janitor)
#install.packages("ggmap")
library(ggmap)
#install.packages("leaflet")
library(leaflet)
register_stadiamaps("98ed9db5-d37d-4aee-af77-e9e3f4d0f242", write = FALSE)
capture <- read.csv("Data/NWTMyotisCaptureRecords_ReimerBarclay2023.csv",
na.strings = c("", " ")
)
library(shiny)
library(shinydashboard)
library(tidyverse)
# -------- LOAD CAPTURE DATA --------
capture_raw <- read.csv(
"Data/NWTMyotisCaptureRecords_ReimerBarclay2023.csv",
na.strings = c("", " ")
)
# Convert to proper types
capture_raw$Region <- as.factor(capture_raw$Region)
capture_raw$Sex <- as.factor(capture_raw$Sex)
capture_raw$Ageclass <- as.factor(capture_raw$Ageclass)
capture_raw$Reproductivestatus <- as.factor(capture_raw$Reproductivestatus)
# Remove NA in variables of interest
capture_clean <- capture_raw %>%
filter(
!is.na(Region),
!is.na(Sex),
!is.na(Ageclass),
!is.na(Reproductivestatus),
!is.na(Forearmlengthmm),
!is.na(Earlengthmm)
)
# -------- REMOVE EAR LENGTH OUTLIERS (IQR method) --------
Q3 <- quantile(capture_clean$Earlengthmm, 0.75)
IQR_val <- IQR(capture_clean$Earlengthmm)
upper_bound <- Q3 + 1.5 * IQR_val
capture <- capture_clean %>%
filter(Earlengthmm <= upper_bound)
# Convert categorical variables
capture$Region <- as.factor(capture$Region)
capture$Sex <- as.factor(capture$Sex)
capture$Ageclass <- as.factor(capture$Ageclass)
capture$Reproductivestatus <- as.factor(capture$Reproductivestatus)
capture %>%
select(Latitude, Longitude) %>%
summary()
lat <- c(59.7, 60.96)
long <-c(-117.4, -112.2)
batbox <- make_bbox(long, lat, f=0.03)
map1 <- get_stadiamap(batbox, maptype="stamen_terrain", zoom=9)
map1 <- get_stadiamap(batbox, maptype="stamen_terrain", zoom=9)
map1 <- get_stadiamap(batbox, maptype="stamen_terrain", zoom=7)
lat <- c(59.7, 60.96)
long <-c(-117.4, -112.2)
batbox <- make_bbox(long, lat, f=0.03)
map1 <- get_stadiamap(batbox, maptype="stamen_terrain", zoom=7)
ggmap(map1)
ggmap(map1) +
geom_point(data=capture, aes(Longitude, Latitude), size=0.75, color="darkred", alpha=.8)+
labs(x="Longitude", y="Latitude", title="Bat Capture Data")
# Load libraries
library(tidyverse)
library(ggmap)
# Read data
data <- read.csv("Data/NWTMyotisAcousticRecords_ReimerBarclay2023.csv", stringsAsFactors = FALSE)
# Clean column names
names(data) <- make.names(names(data))
# Rename columns
data <- data %>%
rename(
site = Site,
lat = Lat,
lon = Lon,
date = night_date,
myotis = Myotis,
detector_active = Detector.Active,
site_type = Site.type
)
# Convert date (MM/DD/YYYY format)
data$date <- as.Date(data$date, format = "%m/%d/%Y")
# Convert Myotis to numeric
data$myotis <- as.numeric(data$myotis)
# Keep only active detector nights
data_clean <- data %>%
filter(detector_active == "Yes")
# Replace missing counts with 0 (only for active nights)
data_clean$myotis[is.na(data_clean$myotis)] <- 0
# Create useful time columns (base R)
data_clean$year  <- format(data_clean$date, "%Y")
data_clean$month <- format(data_clean$date, "%m")
data_clean$doy   <- format(data_clean$date, "%j")  # day of year
# Convert to numeric if needed
data_clean$month <- as.numeric(data_clean$month)
data_clean$doy   <- as.numeric(data_clean$doy)
# Check cleaned data
str(data_clean)
# Save cleaned file
write.csv(data_clean, "bat_data_cleaned.csv", row.names = FALSE)
# Load libraries
library(tidyverse)
library(ggmap)
# Read data
data <- read.csv("Data/NWTMyotisAcousticRecords_ReimerBarclay2023.csv", stringsAsFactors = FALSE)
# Clean column names
names(data) <- make.names(names(data))
# Rename columns
acoustic_data <- data %>%
rename(
site = Site,
lat = Lat,
lon = Lon,
date = night_date,
myotis = Myotis,
detector_active = Detector.Active,
site_type = Site.type
)
# Convert date (MM/DD/YYYY format)
data$date <- as.Date(data$date, format = "%m/%d/%Y")
View(acoustic_data)
# Load libraries
library(tidyverse)
library(ggmap)
# Read data
data <- read.csv("Data/NWTMyotisAcousticRecords_ReimerBarclay2023.csv", stringsAsFactors = FALSE)
# Clean column names
names(data) <- make.names(names(data))
# Rename columns
acoustic_data <- data %>%
rename(
site = Site,
lat = Lat,
lon = Lon,
date = night_date,
myotis = Myotis,
detector_active = Detector.Active,
site_type = Site.type
)
# Convert date (MM/DD/YYYY format)
data$date <- as.Date(data$date, format = "%m/%d/%Y")
# Load libraries
library(tidyverse)
library(ggmap)
# Read data
data <- read.csv("Data/NWTMyotisAcousticRecords_ReimerBarclay2023.csv", stringsAsFactors = FALSE)
# Clean column names
names(data) <- make.names(names(data))
# Rename columns
acoustic_data <- data %>%
rename(
site = Site,
lat = Lat,
lon = Lon,
date = night_date,
myotis = Myotis,
detector_active = Detector.Active,
site_type = Site.type
)
# Convert Myotis to numeric
data$myotis <- as.numeric(data$myotis)
# Load libraries
library(tidyverse)
library(ggmap)
# Read data
data <- read.csv("Data/NWTMyotisAcousticRecords_ReimerBarclay2023.csv", stringsAsFactors = FALSE)
# Clean column names
names(data) <- make.names(names(data))
# Rename columns
acoustic_data <- data %>%
rename(
site = Site,
lat = Lat,
lon = Lon,
date = night_date,
myotis = Myotis,
detector_active = Detector.Active,
site_type = Site.type
)
# Keep only active detector nights
acoustic_data_clean <- data %>%
filter(detector_active == "Yes")
capture <- read.csv("Data/NWTMyotisCaptureRecords_ReimerBarclay2023.csv",
na.strings = c("", " ")
)
library(shiny)
library(shinydashboard)
library(tidyverse)
# -------- LOAD CAPTURE DATA --------
capture_raw <- read.csv(
"Data/NWTMyotisCaptureRecords_ReimerBarclay2023.csv",
na.strings = c("", " ")
)
# Convert to proper types
capture_raw$Region <- as.factor(capture_raw$Region)
capture_raw$Sex <- as.factor(capture_raw$Sex)
capture_raw$Ageclass <- as.factor(capture_raw$Ageclass)
capture_raw$Reproductivestatus <- as.factor(capture_raw$Reproductivestatus)
# Remove NA in variables of interest
capture_clean <- capture_raw %>%
filter(
!is.na(Region),
!is.na(Sex),
!is.na(Ageclass),
!is.na(Reproductivestatus),
!is.na(Forearmlengthmm),
!is.na(Earlengthmm)
)
# -------- REMOVE EAR LENGTH OUTLIERS (IQR method) --------
Q3 <- quantile(capture_clean$Earlengthmm, 0.75)
IQR_val <- IQR(capture_clean$Earlengthmm)
upper_bound <- Q3 + 1.5 * IQR_val
capture <- capture_clean %>%
filter(Earlengthmm <= upper_bound)
# Convert categorical variables
capture$Region <- as.factor(capture$Region)
capture$Sex <- as.factor(capture$Sex)
capture$Ageclass <- as.factor(capture$Ageclass)
capture$Reproductivestatus <- as.factor(capture$Reproductivestatus)
capture %>%
select(Latitude, Longitude) %>%
summary()
lat <- c(59.7, 60.96)
long <-c(-117.4, -112.2)
batbox <- make_bbox(long, lat, f=0.03)
map1 <- get_stadiamap(batbox, maptype="stamen_terrain", zoom=7)
ggmap(map1) +
geom_point(data=capture, aes(Longitude, Latitude), size=0.75, color="darkred", alpha=.8)+
labs(x="Longitude", y="Latitude", title="Bat Capture Data")
